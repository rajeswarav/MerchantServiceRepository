name: Custom Java Build

on:
  push:
    branches: [ "master" ]

jobs:
  build:
    # Use 'self-hosted' label if your runner is registered with this label
    runs-on: [ self-hosted, windows ] 

    steps:
    - uses: actions/checkout@v4

    - name: Set Custom JAVA_HOME Environment Variable
      # We define an environment variable specific to this step and subsequent steps.
      # Note the change from /c/Users/... to C:\Users\... for Windows compatibility.
      run: echo "JAVA_HOME=C:\Users\nvine\.sdkman\candidates\java\current" >> $GITHUB_ENV
      shell: powershell

    - name: Verify Java Version
      run: |
        # Check which Java is being used now that JAVA_HOME is set
        echo "JAVA_HOME is: $JAVA_HOME"
        java -version
      shell: bash # Using bash shell for consistent syntax

    - name: Build with Maven
      run: mvn -B package --file pom.xml
      shell: bash
